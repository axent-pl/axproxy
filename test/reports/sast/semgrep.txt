                   
                   
┌─────────────────┐
│ 5 Code Findings │
└─────────────────┘
                       
    modules/authoidc.go
    ❯❱ go.lang.security.injection.open-redirect.open-redirect
          An HTTP redirect was found to be crafted from user-input `r`. This can lead to open redirect        
          vulnerabilities, potentially allowing attackers to redirect users to malicious web sites. It is     
          recommend where possible to not allow user-input to craft the redirect URL. When user-input is      
          necessary to craft the request, it is recommended to follow OWASP best practices to restrict the URL
          to domains in an allowlist.                                                                         
          Details: https://sg.run/2ZW45                                                                       
                                                                                                              
          202┆ http.Redirect(w, r, entrypoint, http.StatusFound)
                      
    modules/session.go
    ❯❱ go.lang.security.audit.net.cookie-missing-httponly.cookie-missing-httponly
          A session cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies
          instructs the browser to forbid client-side scripts from reading the cookie which mitigates XSS   
          attacks. Set the 'HttpOnly' flag by setting 'HttpOnly' to 'true' in the Cookie.                   
          Details: https://sg.run/b73e                                                                      
                                                                                                            
           ▶▶┆ Autofix ▶ http.Cookie{ Name:     m.cookieName(), Value:    sess.ID, Path:     m.cookiePath(), Domain:
              m.CookieDomain, HttpOnly: m.cookieHTTPOnly(), Secure:   m.cookieSecure(r),                            
              SameSite: m.cookieSameSite(), }                                                                       
          137┆ cookie := &http.Cookie{
          138┆    Name:     m.cookieName(),
          139┆    Value:    sess.ID,
          140┆    Path:     m.cookiePath(),
          141┆    Domain:   m.CookieDomain,
          142┆    HttpOnly: m.cookieHTTPOnly(),
          143┆    Secure:   m.cookieSecure(r),
          144┆    SameSite: m.cookieSameSite(),
          145┆ }
   
    ❯❱ go.lang.security.audit.net.cookie-missing-secure.cookie-missing-secure
          A session cookie was detected without setting the 'Secure' flag. The 'secure' flag for cookies
          prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 
          'Secure' flag by setting 'Secure' to 'true' in the Options struct.                            
          Details: https://sg.run/N4G7                                                                  
                                                                                                        
           ▶▶┆ Autofix ▶ http.Cookie{ Name:     m.cookieName(), Value:    sess.ID, Path:     m.cookiePath(), Domain:
              m.CookieDomain, HttpOnly: m.cookieHTTPOnly(), Secure:   m.cookieSecure(r),                            
              SameSite: m.cookieSameSite(), }                                                                       
          137┆ cookie := &http.Cookie{
          138┆    Name:     m.cookieName(),
          139┆    Value:    sess.ID,
          140┆    Path:     m.cookiePath(),
          141┆    Domain:   m.CookieDomain,
          142┆    HttpOnly: m.cookieHTTPOnly(),
          143┆    Secure:   m.cookieSecure(r),
          144┆    SameSite: m.cookieSameSite(),
          145┆ }
                  
    proxy/proxy.go
    ❯❱ go.lang.security.reverseproxy-director.reverseproxy-director
          ReverseProxy can remove headers added by Director. Consider using ReverseProxy.Rewrite instead of
          ReverseProxy.Director.                                                                           
          Details: https://sg.run/9AYYR                                                                    
                                                                                                           
           71┆ proxy.Director = func(r *http.Request) {
           72┆    st := s.GetState(r.Context())
           73┆    directorHandler(r, st)
           74┆ }
   
    ❯❱ go.lang.security.audit.net.use-tls.use-tls
          Found an HTTP server without TLS. Use 'http.ListenAndServeTLS' instead. See
          https://golang.org/pkg/net/http/#ListenAndServeTLS for more information.   
          Details: https://sg.run/dKbY                                               
                                                                                     
           ▶▶┆ Autofix ▶ http.ListenAndServeTLS(p.Address, certFile, keyFile, rootMux)
          122┆ return http.ListenAndServe(p.Address, rootMux)

