                   
                   
┌─────────────────┐
│ 7 Code Findings │
└─────────────────┘
                                    
    assets/servercerts/localhost.key
   ❯❯❱ generic.secrets.security.detected-private-key.detected-private-key
          Private Key detected. This is a sensitive credential and should not be hardcoded here. Instead,
          store this in a separate, private file.                                                        
          Details: https://sg.run/b7dr                                                                   
                                                                                                         
            1┆ -----BEGIN PRIVATE KEY-----
            2┆ MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCVls51lt04GdUd
                       
    modules/authoidc.go
    ❯❱ go.lang.security.injection.open-redirect.open-redirect
          An HTTP redirect was found to be crafted from user-input `r`. This can lead to open redirect        
          vulnerabilities, potentially allowing attackers to redirect users to malicious web sites. It is     
          recommend where possible to not allow user-input to craft the redirect URL. When user-input is      
          necessary to craft the request, it is recommended to follow OWASP best practices to restrict the URL
          to domains in an allowlist.                                                                         
          Details: https://sg.run/2ZW45                                                                       
                                                                                                              
           88┆ http.Redirect(w, r, loginURL.String(), http.StatusFound)
            ⋮┆----------------------------------------
          263┆ http.Redirect(w, r, entrypoint, http.StatusFound)
                              
    modules/enrichment/ldap.go
    ❯❱ go.lang.security.audit.crypto.missing-ssl-minversion.missing-ssl-minversion
          `MinVersion` is missing from this TLS configuration.  By default, as of Go 1.22, TLS 1.2 is         
          currently used as the minimum. General purpose web applications should default to TLS 1.3 with all  
          other protocols disabled.  Only where it is known that a web server must support legacy clients with
          unsupported an insecure browsers (such as Internet Explorer 10), it may be necessary to enable TLS  
          1.0 to provide support. Add `MinVersion: tls.VersionTLS13' to the TLS configuration to bump the     
          minimum version to TLS 1.3.                                                                         
          Details: https://sg.run/oxEN                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ tls.Config{ InsecureSkipVerify: cfg.TLSInsecureSkipVerify, MinVersion: tls.VersionTLS13 }
          105┆ tlsCfg := &tls.Config{
          106┆    InsecureSkipVerify: cfg.TLSInsecureSkipVerify,
          107┆ }
                      
    modules/session.go
    ❯❱ go.lang.security.audit.net.cookie-missing-httponly.cookie-missing-httponly
          A session cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies
          instructs the browser to forbid client-side scripts from reading the cookie which mitigates XSS   
          attacks. Set the 'HttpOnly' flag by setting 'HttpOnly' to 'true' in the Cookie.                   
          Details: https://sg.run/b73e                                                                      
                                                                                                            
           ▶▶┆ Autofix ▶ http.Cookie{ Name:     m.cookieName(), Value:    sess.ID, Path:     m.cookiePath(), Domain:
              m.CookieDomain, HttpOnly: m.cookieHTTPOnly(), Secure:   m.cookieSecure(r),                            
              SameSite: m.cookieSameSite(), }                                                                       
          137┆ cookie := &http.Cookie{
          138┆    Name:     m.cookieName(),
          139┆    Value:    sess.ID,
          140┆    Path:     m.cookiePath(),
          141┆    Domain:   m.CookieDomain,
          142┆    HttpOnly: m.cookieHTTPOnly(),
          143┆    Secure:   m.cookieSecure(r),
          144┆    SameSite: m.cookieSameSite(),
          145┆ }
   
    ❯❱ go.lang.security.audit.net.cookie-missing-secure.cookie-missing-secure
          A session cookie was detected without setting the 'Secure' flag. The 'secure' flag for cookies
          prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 
          'Secure' flag by setting 'Secure' to 'true' in the Options struct.                            
          Details: https://sg.run/N4G7                                                                  
                                                                                                        
           ▶▶┆ Autofix ▶ http.Cookie{ Name:     m.cookieName(), Value:    sess.ID, Path:     m.cookiePath(), Domain:
              m.CookieDomain, HttpOnly: m.cookieHTTPOnly(), Secure:   m.cookieSecure(r),                            
              SameSite: m.cookieSameSite(), }                                                                       
          137┆ cookie := &http.Cookie{
          138┆    Name:     m.cookieName(),
          139┆    Value:    sess.ID,
          140┆    Path:     m.cookiePath(),
          141┆    Domain:   m.CookieDomain,
          142┆    HttpOnly: m.cookieHTTPOnly(),
          143┆    Secure:   m.cookieSecure(r),
          144┆    SameSite: m.cookieSameSite(),
          145┆ }
                  
    proxy/proxy.go
    ❯❱ go.lang.security.reverseproxy-director.reverseproxy-director
          ReverseProxy can remove headers added by Director. Consider using ReverseProxy.Rewrite instead of
          ReverseProxy.Director.                                                                           
          Details: https://sg.run/9AYYR                                                                    
                                                                                                           
           73┆ proxy.Director = func(r *http.Request) {
           74┆    st := s.GetState(r.Context())
           75┆    directorHandler(r, st)
           76┆ }

